## WitMotion Connect
### Подготовка системы
Тестировано на Python 3.12, должно работать от 3.10

Клонируйте гит и запускайте `WitMotionConnect.py`

### Работа с ПО
Предварительные условия: ПО запущено и датчик подключен к ПК

1. Установите Baud rate на нужном уровне (дефолт: `460800`)
2. Настройте порт подключения серийного конвертера (Linux: `/dev/ttyUSB0`, Windows: `COM3`)
3. Выберите режим записи (9DoF, 6DoF), формат подключенного датчика (Single, Double, WitMotion)
4. Выберите формат сохранения данных (h5, csv, npz) - по умолчанию npz
5. Нажмите "Подключить датчик"
6. Когда будете готовы к записи, нажмите "Начать запись"

### Использование дешифратора
ПО сохраняет данные в формате таблицы HDF/csv/npz, в которую записаны данные датчиков, полученные напрямую с них. Для работы с ними следует перевести их в читаемый вид с помощью дешифратора.
1. В меню "Опции" выберите "Дешифратор".
2. В новом окне нажмите "Выбрать файл".
3. Выберите файл и его формат - файлы хранятся в каталоге `WitMotionConnect/data`.
4. Не меняя других параметров, нажмите "Дешифровать".
5. Файл сохранится с расширением `.csv` в каталог `/data`.

### Использование карты захвата
ПО поддерживает работу с картой захвата. Подключите ее к ПК по следующей инструкции:
1. USB соединяет карту и ПК (Type-C в карту, совмещенный разъем в ПК в подходящем формате)
2. HDMI подключить к выходу на УЗИ-аппарате и разъему HDMI IN на карте захвата.

Подключение на уровне ПО объединено с кнопкой "Подключить датчик". Перед подключением рекомендуется проверить параметры карты в разделе Опции-Настройки.

Запись осуществляется в разных форматах, в зависимости от ОС: mp4 на Windows, avi на Linux.

### Калибровка датчиков
Калибровка гироскопа и акселерометра происходит при подключении датчика к ПК, не зависимо от использования WitMotionConnect (в случае включения этой функции в прошивке).
В связи с этим подключайте датчик, когда он находится в горизонтальном спокойном положении.

Калибровка требует определенного времени (~10 секунд), подключение датчика в ПО требуется проводить после этого.

В случае необходимости калибровки магнетометров, выберите в меню опций "Калибровка магнетометра" и следуйте инструкциям.

### Сборка пакета
При сборке через pyinstaller необходимо добавить папку utils/GUI; tables и blosc2 как hidden-import:
```
--add-data "utils/GUI:utils/GUI"
```
```
--hidden-import=tables --hidden-import=blosc2 --collect-binaries=tables
```
Помимо этого, добавить в пути к .ui файлам:
```
os.path.join(sys._MEIPASS, ui_file_path)
```
Пример команды для сборки:
```
pyinstaller --console --onedir --add-data "utils/GUI:utils/GUI" --hidden-import=tables --hidden-import=blosc2 --collect-binaries=tables WitMotionConnect.py
```
